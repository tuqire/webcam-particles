webpackJsonp([0],[,,,,function(e,t,n){e.exports=n(5)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}var o=n(1),a=i(o),s=n(6),u=i(s),l=n(7),c=i(l),d=n(9),h=i(d),f=n(10),v=i(f),m=n(11),p=i(m),y=n(12),g=i(y);document.addEventListener("DOMContentLoaded",function(){if(a.default){var e=window.innerWidth,t=window.innerHeight,n=document.getElementById("container"),i=new h.default({width:e,height:t,container:n}),o=new p.default,s=new u.default({aspectRatio:1,position:{x:0,y:0,z:-1.5}}),l=new c.default({minDistance:0,maxDistance:1700,camera:s.get(),rendererDomElement:i.getDomElement()}),d=new v.default,f=new g.default({numParticles:3e4,scene:o,renderer:i}),m=function(){s.update(),d.update(),f.update(),i.render({scene:o.get(),camera:s.get()})};!function(){l.onChange(m),"true"===r("stats")&&n.appendChild(d.getDomElement())}(),function e(){requestAnimationFrame(e),l.update(),m()}()}else{document.getElementById("info").innerHTML="Your browser is not supported. Please use the latest version of Firefox or Chrome."}})},function(e,t,n){"use strict";(function(e){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function t(i){var r=i.fov,o=void 0===r?45:r,a=i.aspectRatio,s=void 0===a?window.innerHeight/window.innerWidth:a,u=i.near,l=void 0===u?.01:u,c=i.far,d=void 0===c?500:c,h=i.position,f=void 0===h?{x:0,y:0,z:0}:h;i.up;n(this,t),this.camera=new e.PerspectiveCamera(o,s,l,d),this.setPosition(f),window.addEventListener("resize",this.onWindowResize.bind(this))}return i(t,[{key:"onWindowResize",value:function(){var e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix()}},{key:"setUp",value:function(e,t,n){this.camera.up.set(e,t,n)}},{key:"setPosition",value:function(e){var t=e.x,n=void 0===t?this.camera.position.x:t,i=e.y,r=void 0===i?this.camera.position.y:i,o=e.z,a=void 0===o?this.camera.position.z:o;this.setX(n),this.setY(r),this.setZ(a)}},{key:"setX",value:function(e){this.camera.position.x=e}},{key:"setY",value:function(e){this.camera.position.y=e}},{key:"setZ",value:function(e){this.camera.position.z=e}},{key:"update",value:function(){}},{key:"get",value:function(){return this.camera}}]),t}();t.default=r}).call(t,n(0))},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(2),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){var n=t.camera,r=t.rendererDomElement,o=void 0===r?null:r,s=t.rotateSpeed,u=void 0===s?1:s,l=t.zoomSpeed,c=void 0===l?1:l,d=t.panSpeed,h=void 0===d?1:d,f=t.noPan,v=void 0!==f&&f,m=t.staticMoving,p=void 0===m||m,y=t.dynamicDampingFactor,g=void 0===y?0:y,w=t.minDistance,S=void 0===w?0:w,b=t.maxDistance,P=void 0===b?1/0:b,x=t.keys,z=void 0===x?[65,83,68]:x;i(this,e),this.controls=new a.default(n,o),this.controls.rotateSpeed=u,this.controls.zoomSpeed=c,this.controls.panSpeed=h,this.controls.noPan=v,this.controls.staticMoving=p,this.controls.dynamicDampingFactor=g,this.controls.minDistance=S,this.controls.maxDistance=P,this.controls.keys=z}return r(e,[{key:"onChange",value:function(e){this.controls.addEventListener("change",e)}},{key:"update",value:function(){this.controls.update()}}]),e}();t.default=s},,function(e,t,n){"use strict";(function(e){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function t(i){var r=i.alpha,o=void 0===r||r,a=i.pixelRatio,s=void 0===a?window.devicePixelRatio:a,u=i.width,l=void 0===u?window.width:u,c=i.height,d=void 0===c?window.height:c,h=i.container;n(this,t),this.renderer=new e.WebGLRenderer({alpha:o});var f=this.renderer.context;f.enable(f.BLEND),f.blendFunc(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA),this.setPixelRatio(s),this.setSize(l,d),h.appendChild(this.getDomElement()),window.addEventListener("resize",this.onWindowResize.bind(this))}return i(t,[{key:"getDomElement",value:function(e){return this.renderer.domElement}},{key:"onWindowResize",value:function(){var e=window.innerWidth,t=window.innerHeight;this.renderer.setSize(e,t)}},{key:"setPixelRatio",value:function(e){this.renderer.setPixelRatio(e)}},{key:"setSize",value:function(e,t){this.renderer.setSize(e,t)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scene,n=e.camera,i=e.renderTarget,r=void 0===i?null:i,o=e.force,a=void 0!==o&&o;this.renderer.render(t,n,r,a)}},{key:"get",value:function(){return this.renderer}}]),t}();t.default=r}).call(t,n(0))},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(3),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(){i(this,e),this.stats=new a.default}return r(e,[{key:"getDomElement",value:function(e){return this.stats.domElement}},{key:"update",value:function(){this.stats.update()}}]),e}();t.default=s},function(e,t,n){"use strict";(function(e){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function t(){n(this,t),this.scene=new e.Scene,this.scene.background=new e.Color(16777215)}return i(t,[{key:"add",value:function(e){this.scene.add(e)}},{key:"remove",value:function(e){this.scene.remove(e)}},{key:"get",value:function(){return this.scene}}]),t}();t.default=r}).call(t,n(0))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(13),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=n(14),u=n(15),l=function(){function t(n){var r=this,o=n.scene,a=n.numParticles,s=void 0===a?1e5:a,u=n.uniforms,l=void 0===u?{sizeMultipler:{value:window.innerHeight*window.devicePixelRatio/2},color:{value:new e.Color(16777215)}}:u,c=n.blending,d=(void 0===c&&e.AdditiveBlending,n.transparent,n.depthTest,n.depthWrite,n.renderer),h=n.particleSize,f=void 0===h?.06:h,v=n.particleSizeInc,m=void 0===v?2e-4:v,p=n.zInc,y=void 0===p?3e-4:p,g=n.yInc,w=void 0===g?7e-4:g,S=n.yThreshold,b=void 0===S?.2:S;i(this,t),this.scene=o,this.numParticles=s,this.renderer=d,this.uniforms=l,this.particleSize=f,this.particleSizeInc=m,this.zInc=y,this.yInc=w,this.yThreshold=b,this.windowHalfX=window.innerWidth/2,this.windowHalfY=window.innerHeight/2,this.video=document.createElement("video");var P=(navigator.getUserMedia||navigator.mediaDevices.getUserMedia,document.createElement("h1"));P.innerHTML="Your browser is not supported. Please use Google Chrome (v21 or above).",navigator.getUserMedia?navigator.getUserMedia({video:{width:1280,height:720}},function(e){var t=r.video;t.src=URL.createObjectURL(e),t.width=480,t.height=480,r.addParticles()},function(){return console.error("video failed to load")}):document.getElementsByTagName("body")[0].append(P)}return r(t,[{key:"onDocumentMouseMove",value:function(e){this.mouseX=this.windowHalfX-e.clientX,this.mouseY=e.clientY-this.windowHalfY,this.FBO.simulationShader.uniforms.mouse.value.set(.5*this.mouseX/this.windowHalfX,-.5*this.mouseY/this.windowHalfY,0)}},{key:"addParticles",value:function(){for(var t=this.video,n=this.renderer,i=this.numParticles,r=t.width/t.height,o=r>1?r:1,l=r>1?1:t.height/t.width,c=o,d=l;c*d<i-o*l;)c+=o,d+=l;var h=Math.ceil(c),f=Math.ceil(d);this.numParticles=h*f,this.FBO=new a.default({tWidth:h,tHeight:f,renderer:n,uniforms:{tWidth:{type:"f",value:h},tHeight:{type:"f",value:f},mouse:{value:new e.Vector3(1e4,1e4,1e4)},tSize:{type:"t",value:0},yThreshold:{type:"f",value:this.yThreshold}},simulationVertexShader:s.simulationVertexShader,simulationFragmentShader:s.simulationFragmentShader}),this.FBO.setTextureUniform("tSize",this.getSizes());var v=this.videoImage=document.createElement("canvas"),m=(this.videoImageContext=v.getContext("2d"),this.videoTexture=new e.Texture(v));m.minFilter=m.magFilter=e.NearestFilter,m.needsUpdate=!0;for(var p=this.material=new e.ShaderMaterial({blending:e.NormalBlending,uniforms:Object.assign({},this.uniforms,{tTexture:{type:"t",value:m},tFrame:{type:"t",value:this.FBO.targets[0]}}),fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,opacity:1,vertexColors:!0,transparent:!0}),y=this.geometry=new e.Geometry,g=0;g<this.numParticles;g++){var w=new e.Vector3;w.x=g%h/h,w.y=Math.floor(g/h)/f,y.vertices.push(w)}this.particles=new e.Points(y,p),this.particles.frustumCulled=!1,this.scene.add(this.get()),console.log("scene loaded!","Expected: "+this.numParticles+" particles","Actual: "+y.vertices.length+" particles","Cols: "+h,"Rows: "+f),this.ready=!0,document.addEventListener("mousemove",this.onDocumentMouseMove.bind(this),!1)}},{key:"getSizes",value:function(){for(var e=new Float32Array(4*this.numParticles),t=0,n=0;t<this.numParticles;t++,n+=4)e[n]=this.zInc*Math.random(),e[n+1]=this.yInc*(Math.random()/2+.5),e[n+2]=this.calcSize(),e[n+3]=this.particleSizeInc*Math.random();return e}},{key:"calcSize",value:function(){return this.particleSize*Math.random()}},{key:"update",value:function(){if(this.ready){var e=this.video,t=this.videoImageContext,n=this.videoImage,i=n.width,r=n.height,o=this.videoTexture;e.readyState===e.HAVE_ENOUGH_DATA&&(t.drawImage(e,0,0,i,r),o.needsUpdate=!0),this.FBO.simulate(),this.material.uniforms.tFrame.value=this.FBO.getCurrentFrame()}}},{key:"get",value:function(){return this.particles}}]),t}();t.default=l}).call(t,n(0))},function(e,t,n){"use strict";(function(e){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.tWidth,o=void 0===r?512:r,a=i.tHeight,s=void 0===a?512:a,u=i.numTargets,l=void 0===u?3:u,c=i.filterType,d=void 0===c?e.LinearFilter:c,h=i.format,f=void 0===h?e.RGBAFormat:h,v=i.type,m=void 0===v?e.FloatType:v,p=i.renderer,y=i.uniforms,g=i.simulationVertexShader,w=i.simulationFragmentShader;n(this,t),this.tWidth=o,this.tHeight=s,this.numTargets=l,this.filterType=d,this.format=f,this.type=m,this.renderer=p,this.simulationShader=new e.ShaderMaterial({uniforms:Object.assign({},y,{tPrevFrame:{type:"t",value:null},tFrame:{type:"t",value:null}}),vertexShader:g,fragmentShader:w}),this.targets=[];for(var S=0;S<this.numTargets;S++)this.targets.push(this.createTarget());this.cameraRTT=new e.OrthographicCamera(-o/2,o/2,s/2,-s/2,-1e6,1e6),this.cameraRTT.position.z=100,this.sceneRTTPos=new e.Scene,this.sceneRTTPos.add(this.cameraRTT),this.plane=new e.PlaneBufferGeometry(o,s);var b=new e.Mesh(this.plane,this.simulationShader);b.position.z=-1,this.sceneRTTPos.add(b),this.count=-1}return r(t,[{key:"createTarget",value:function(){var t=new e.WebGLRenderTarget(this.tWidth,this.tHeight,{minFilter:this.filterType,magFilter:this.filterType,format:this.format,type:this.type,depthBuffer:!1,stencilBuffer:!1,antialias:!0});return t.texture.generateMipmaps=!1,t}},{key:"setBufferAttribute",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;this.plane.addAttribute(t,new e.BufferAttribute(n,i))}},{key:"setTextureUniform",value:function(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.format,a=new e.DataTexture(n,this.tWidth,this.tHeight,o,this.type);a.minFilter=a.magFilter=this.filterType,a.needsUpdate=!0,a.flipY=!1,"object"===(void 0===t?"undefined":i(t))?t.forEach(function(e){return r.simulationShader.uniforms[e].value=a}):this.simulationShader.uniforms[t].value=a}},{key:"simulate",value:function(){++this.count===this.numTargets&&(this.count=0);var e=(0===this.count?this.numTargets:this.count)-1,t=this.targets[e];this.renderer.render({scene:this.sceneRTTPos,camera:this.cameraRTT,renderTarget:this.getCurrentFrame(),force:!1}),this.simulationShader.uniforms.tPrevFrame.value=t,this.simulationShader.uniforms.tFrame.value=this.getCurrentFrame()}},{key:"getCurrentFrame",value:function(){return this.targets[this.count]}}]),t}();t.default=o}).call(t,n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.simulationFragmentShader="\n\t/** generates a random number between 0 and 1 **/\n\thighp float rand(vec2 co)\n\t{\n\t\thighp float a = 12.9898;\n\t\thighp float b = 78.233;\n\t\thighp float c = 43758.5453;\n\t\thighp float dt= dot(co.xy ,vec2(a,b));\n\t\thighp float sn= mod(dt,3.14);\n\t\treturn fract(sin(sn) * c);\n\t}\n\n\tvarying vec2 vUv;\n\n\tuniform sampler2D tPrevFrame;\n\tuniform sampler2D tFrame;\n\n\tuniform vec3 mouse;\n\tuniform sampler2D tSize;\n\tuniform float yThreshold;\n\n\tuniform float tWidth;\n\tuniform float tHeight;\n\n\tvec3 getPos(vec3 defaultPos) {\n\t\tvec3 prevPos = texture2D(tPrevFrame, vUv).xyz;\n\t\tvec3 currPos = texture2D(tFrame, vUv).xyz;\n\t\tfloat xInc = texture2D(tSize, vUv).x;\n\t\tfloat yInc = texture2D(tSize, vUv).y;\n\n\t\tvec3 pos = currPos;\n\n\t\tfloat dist = length(pos - mouse);\n\n\t\tif (dist < 0.07) {\n\t\t\tpos += pos - mouse;\n\t\t} else if (pos == vec3(0.0, 0.0, 0.0) || pos.y - yThreshold > defaultPos.y) {\n\t\t\tpos = defaultPos;\n\t\t} else {\n\t\t\tpos.y += yInc;\n\t\t\tpos.x += rand(vec2(defaultPos.x, defaultPos.y)) > 0.5 ? xInc : -xInc;\n\t\t}\n\n\t\treturn pos;\n\t}\n\n\tfloat getSize(vec3 defaultPos, vec3 pos) {\n\t\tfloat defaultSize = texture2D(tSize, vUv).z;\n\t\tfloat incSize = texture2D(tSize, vUv).w;\n\t\tfloat currSize = texture2D(tFrame, vUv).w;\n\n\t\tcurrSize += incSize;\n\n\t\tcurrSize += currSize > defaultSize + (incSize * 60.0) ? 0.0 : incSize;\n\n\t\tif (pos.y == defaultPos.y) {\n\t\t\tcurrSize = defaultSize / 2.0;\n\t\t}\n\n\t\treturn currSize;\n\t}\n\n\tvoid main() {\n\t\tvec3 defaultPos = vec3((vUv.x * 1.0) - 0.5, (vUv.y * 1.0) - 0.5, 0.0);\n\n\t\tvec3 pos = getPos(defaultPos);\n\t\tfloat size = getSize(defaultPos, pos);\n\n\t\t// write new position out\n\t\tgl_FragColor = vec4(pos, size);\n\t}\n",t.simulationVertexShader="\n\tvarying vec2 vUv;\n\n\tvoid main() {\n\t  vUv = vec2(uv);\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t}\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fragmentShader="\n\tuniform sampler2D tTexture;\n\n\tvarying vec2 vUv;\n\n\tvoid main() {\n\t\tvec3 colors = texture2D(tTexture, vUv).xyz;\n\n\t\tgl_FragColor = vec4(colors, 1.0);\n\t\tif (length(gl_PointCoord - vec2(0.5, 0.5)) > 0.475) discard;\n\t}\n",t.vertexShader="\n\tuniform sampler2D tFrame;\n\tuniform float sizeMultipler;\n\n\tvarying vec2 vUv;\n\n\tvoid main() {\n\t\tvUv = position.xy;\n\n\t\t// position saved as color value in a texture object in memory\n\t\tvec3 pos = texture2D(tFrame, vUv).xyz;\n\t\tfloat size = texture2D(tFrame, vUv).w;\n\n\t\tvec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\t\tgl_PointSize = size * (sizeMultipler / -mvPosition.z);\n\t\tgl_Position = projectionMatrix * mvPosition;\n\t}\n"}],[4]);
//# sourceMappingURL=bundle.js.map